{% extends 'header.html.twig' %}
{% block javascripts %}
    <script src="https://polyfill.io/v3/polyfill.min.js?version=3.52.1&features=fetch"></script>
    <script src="https://js.stripe.com/v3/"></script>

{#    <script type="text/javascript">#}
{#        // Create an instance of the Stripe object with your publishable API key#}
{#        var stripe = Stripe("pk_test_51HcSYAHXcHwl9YC7v5nGnYRq6PW6VVePnMcUhqFNsHVbAyWLVnwRDqNFVKLIbTsKYO5SF9PEMv0LsKv4UOiNhm2p00Oy434qUS");#}
{#        var checkoutButton = document.getElementById("checkout-button");#}
{#        checkoutButton.addEventListener("click", function () {#}
{#            fetch("/paiement", {#}
{#                method: "POST",#}
{#            })#}
{#                .then(function (response) {#}
{#                    return response.json();#}
{#                })#}
{#                .then(function (session) {#}
{#                    return stripe.redirectToCheckout({sessionId: session.id});#}
{#                })#}
{#                .then(function (result) {#}
{#                    // If redirectToCheckout fails due to a browser or network#}
{#                    // error, you should display the localized error message to your#}
{#                    // customer using error.message.#}
{#                    if (result.error == 'order') {#}
{#                        console.log("order incorecte");#}
{#                    }#}
{#                    if (result.error) {#}
{#                        alert(result.error.message);#}
{#                    }#}
{#                })#}
{#                .catch(function (error) {#}
{#                    console.error("Error:", error);#}
{#                });#}
{#        });#}
{#    </script>#}
{% endblock %}

{% block body %}
    <h1>VOTRE COMMANDE</h1>
    {% for item in app.session.get('cart') %}
        {{ dump(item) }}
    {% endfor %}
    <br>
    <br>
    <h2>METHODE DE LIVRAISON</h2>
    {{ delivery }}
    <br>
    <br>
    <h2>ADRESSE DE LIVRAISON</h2>
    {{ address|raw }}
    <h2>PRIX TOTAL</h2>
    AFFICHER LE PRIX TOTAL
    <form action="/paiement" method="POST">
        <button type="submit" id="checkout-button">Checkout</button>
    </form>
{% endblock %}
